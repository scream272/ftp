#!  /usr/bin/python
# _*_coding:utf-8_*_


# socket??ftp

'''
ftp???????ftp????????????????????????????????????????????????????????
          ????????????????????????

          ?????????????????????????FTP???????????????????????????????

          1.FTP????21??????????1???FTP????????????????1???????????????????
          2.?????????????????????????????????????????????????????????????

?????????????


'''

import socket, os, sys, thread

# socket??????socket??????????????????????????
# Thread??????thread.start_new_thread(),?????????????????????????????????????????????


#??????socket???21????????while????????????????????????????
#?????????while????????????????????????????????????handler????
#?????????????????socket???

class FTPs():
    def __init__(self, localhost = '127.0.0.1', path = 'c:/'):
        self.s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

        self.size = 4096
        self.localhost = localhost

        #???FTP?????21
        try:
            self.s.bind((self.localhost, 21))
        except:
            print 'ERROR'
            raise
        self.close = False


    def Run(self):
        self.s.listen(5)
        socket.setdefaulttimeout(60)
        while 1:
            try:
                conn,addr = self.s.accept()
            except KeyboardInterrupt:
                self.close = True
                conn.close()
                self.s.close()
                break
            thread.start_new_thread(self.cftpcmd, (conn, ))

    def cftpcmd(self, cnn, ):
        cpath = self.path.replace('\\', '/')
        os.chdir(cpath)

        # ????????????????socket
        cf = cnn.makefile('rw', 0)
        cf.write('')


        #???????????
        dsocket = None
        #????????????
        selfclose = False
        while 1:
            try:
                gets = cf.readline().strip()





























